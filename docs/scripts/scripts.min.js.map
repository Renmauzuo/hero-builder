{"version":3,"file":"scripts.min.js","sources":["src/scripts/scripts.js"],"sourcesContent":["var exporter, scene, link, character, weapon, weaponBone, loader;\r\n\r\nconst weapons = {\r\n    longsword: {\r\n        model: 'Longsword'\r\n    },\r\n    mace: {\r\n        model: 'Mace'\r\n    },\r\n    maul: {\r\n        model: 'Maul'\r\n    }\r\n}\r\n\r\n$(function () {\r\n    link = document.createElement( 'a' );\r\n    link.style.display = 'none';\r\n    document.body.appendChild( link );\r\n    link.download = 'scene.stl';\r\n\r\n    loader = new THREE.GLTFLoader();\r\n    exporter = new THREE.STLExporter();\r\n\r\n    let animationWidth = $('#viewport').width();\r\n    let animationHeight = $('#viewport').height();\r\n    scene = new THREE.Scene();\r\n    scene.background = new THREE.Color( 0x808080 );\r\n    const camera = new THREE.PerspectiveCamera( 75, animationWidth / animationHeight, 0.1, 1000 );\r\n    \r\n    const renderer = new THREE.WebGLRenderer();\r\n    renderer.setSize( animationWidth, animationHeight );\r\n    $('#viewport').append(renderer.domElement);\r\n    const geometry = new THREE.BoxGeometry();\r\n    const material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );\r\n    //const cube = new THREE.Mesh( geometry, material );\r\n    //scene.add( cube );\r\n\r\n\r\n    var light = new THREE.AmbientLight( 0x404040 );\r\n    scene.add(light);\r\n\r\n    const controls = new THREE.OrbitControls( camera, renderer.domElement );\r\n\r\n    //controls.update() must be called after any manual changes to the camera's transform\r\n    camera.position.set( 0, 30, 100 );\r\n    controls.update();\r\n    \r\n    //camera.position.y = 2;\r\n    //camera.position.z = 5;\r\n\r\n    function animate() {\r\n        requestAnimationFrame( animate );\r\n        renderer.render( scene, camera );\r\n    }\r\n    animate();\r\n\r\n    let model = 'Female-Rigged-2';\r\n    //let model = 'Female-Body-Rigged-NEW';\r\n    //let model = 'Dwarf-Female-Druid-2';\r\n    loader.load( '../models/characters/'+model+'.glb', function ( gltf ) {\r\n        gltf.scene.traverse( child => {\r\n\r\n            if ( child.material ) child.material.metalness = 0;\r\n        \r\n        } );\r\n        character = gltf.scene.children[0];\r\n        weaponBone = character.children[0];\r\n        scene.add( gltf.scene );\r\n\r\n    \r\n    }, undefined, function ( error ) {\r\n    \r\n        console.error( error );\r\n    \r\n    } );\r\n\r\n    $('#weapon-select').on('change', updateCharacterWeapon);\r\n\r\n});\r\n\r\nfunction downloadSTL() {\r\n    console.log('download');\r\n    let result = exporter.parse( scene, { binary: true } );\r\n    let blob = new Blob( [ result ], { type: 'application/octet-stream' } );\r\n    link.href = URL.createObjectURL( blob );\r\n    link.click();\r\n}\r\n\r\nfunction updateCharacterWeapon () {\r\n    //Remove old weapon\r\n    weaponBone.remove(weapon);\r\n    let target = $('#weapon-select').val();\r\n    if (target.length) {\r\n\r\n        let model = weapons[target].model;\r\n        loader.load( '../models/weapons/'+model+'.glb', function ( gltf ) {\r\n            gltf.scene.traverse( child => {\r\n    \r\n                if ( child.material ) child.material.metalness = 0;\r\n            \r\n            } );\r\n            weapon = gltf.scene.children[0];\r\n            weapon.rotation.set(3.14159, 0, 0);\r\n            weapon.position.set(.1,.1,-0.1);\r\n            let weaponScale = .1;\r\n            weapon.scale.set(weaponScale, weaponScale, weaponScale);\r\n            weaponBone.add( weapon );\r\n        }, undefined, function ( error ) {\r\n        \r\n            console.error( error );\r\n        \r\n        } );\r\n    }\r\n}"],"names":["exporter","scene","link","character","weapon","weaponBone","loader","weapons","longsword","model","mace","maul","$","document","createElement","style","display","body","appendChild","download","THREE","GLTFLoader","STLExporter","animationWidth","width","animationHeight","height","Scene","background","Color","camera","PerspectiveCamera","renderer","WebGLRenderer","setSize","append","domElement","geometry","BoxGeometry","material","MeshBasicMaterial","color","light","AmbientLight","add","controls","OrbitControls","position","set","update","animate","requestAnimationFrame","render","load","gltf","traverse","child","metalness","children","undefined","error","console","on","updateCharacterWeapon","downloadSTL","log","result","parse","binary","blob","Blob","type","href","URL","createObjectURL","click","remove","target","val","length","rotation","weaponScale","scale"],"mappings":";;AAAA,IAAIA,QAAJ,EAAcC,KAAd,EAAqBC,IAArB,EAA2BC,SAA3B,EAAsCC,MAAtC,EAA8CC,UAA9C,EAA0DC,MAA1D;AAEA,MAAMC,OAAO,GAAG;AACZC,EAAAA,SAAS,EAAE;AACPC,IAAAA,KAAK,EAAE;AADA,GADC;AAIZC,EAAAA,IAAI,EAAE;AACFD,IAAAA,KAAK,EAAE;AADL,GAJM;AAOZE,EAAAA,IAAI,EAAE;AACFF,IAAAA,KAAK,EAAE;AADL;AAPM,CAAhB;AAYAG,CAAC,CAAC,YAAY;AACVV,EAAAA,IAAI,GAAGW,QAAQ,CAACC,aAAT,CAAwB,GAAxB,CAAP;AACAZ,EAAAA,IAAI,CAACa,KAAL,CAAWC,OAAX,GAAqB,MAArB;AACAH,EAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA2BhB,IAA3B;AACAA,EAAAA,IAAI,CAACiB,QAAL,GAAgB,WAAhB;AAEAb,EAAAA,MAAM,GAAG,IAAIc,KAAK,CAACC,UAAV,EAAT;AACArB,EAAAA,QAAQ,GAAG,IAAIoB,KAAK,CAACE,WAAV,EAAX;AAEA,MAAIC,cAAc,GAAGX,CAAC,CAAC,WAAD,CAAD,CAAeY,KAAf,EAArB;AACA,MAAIC,eAAe,GAAGb,CAAC,CAAC,WAAD,CAAD,CAAec,MAAf,EAAtB;AACAzB,EAAAA,KAAK,GAAG,IAAImB,KAAK,CAACO,KAAV,EAAR;AACA1B,EAAAA,KAAK,CAAC2B,UAAN,GAAmB,IAAIR,KAAK,CAACS,KAAV,CAAiB,QAAjB,CAAnB;AACA,QAAMC,MAAM,GAAG,IAAIV,KAAK,CAACW,iBAAV,CAA6B,EAA7B,EAAiCR,cAAc,GAAGE,eAAlD,EAAmE,GAAnE,EAAwE,IAAxE,CAAf;AAEA,QAAMO,QAAQ,GAAG,IAAIZ,KAAK,CAACa,aAAV,EAAjB;AACAD,EAAAA,QAAQ,CAACE,OAAT,CAAkBX,cAAlB,EAAkCE,eAAlC;AACAb,EAAAA,CAAC,CAAC,WAAD,CAAD,CAAeuB,MAAf,CAAsBH,QAAQ,CAACI,UAA/B;AACA,QAAMC,QAAQ,GAAG,IAAIjB,KAAK,CAACkB,WAAV,EAAjB;AACA,QAAMC,QAAQ,GAAG,IAAInB,KAAK,CAACoB,iBAAV,CAA6B;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAA7B,CAAjB,CAnBU;AAqBV;;AAGA,MAAIC,KAAK,GAAG,IAAItB,KAAK,CAACuB,YAAV,CAAwB,QAAxB,CAAZ;AACA1C,EAAAA,KAAK,CAAC2C,GAAN,CAAUF,KAAV;AAEA,QAAMG,QAAQ,GAAG,IAAIzB,KAAK,CAAC0B,aAAV,CAAyBhB,MAAzB,EAAiCE,QAAQ,CAACI,UAA1C,CAAjB,CA3BU;;AA8BVN,EAAAA,MAAM,CAACiB,QAAP,CAAgBC,GAAhB,CAAqB,CAArB,EAAwB,EAAxB,EAA4B,GAA5B;AACAH,EAAAA,QAAQ,CAACI,MAAT,GA/BU;AAkCV;;AAEA,WAASC,OAAT,GAAmB;AACfC,IAAAA,qBAAqB,CAAED,OAAF,CAArB;AACAlB,IAAAA,QAAQ,CAACoB,MAAT,CAAiBnD,KAAjB,EAAwB6B,MAAxB;AACH;;AACDoB,EAAAA,OAAO;AAEP,MAAIzC,KAAK,GAAG,iBAAZ,CA1CU;AA4CV;;AACAH,EAAAA,MAAM,CAAC+C,IAAP,CAAa,0BAAwB5C,KAAxB,GAA8B,MAA3C,EAAmD,UAAW6C,IAAX,EAAkB;AACjEA,IAAAA,IAAI,CAACrD,KAAL,CAAWsD,QAAX,CAAqBC,KAAK,IAAI;AAE1B,UAAKA,KAAK,CAACjB,QAAX,EAAsBiB,KAAK,CAACjB,QAAN,CAAekB,SAAf,GAA2B,CAA3B;AAEzB,KAJD;AAKAtD,IAAAA,SAAS,GAAGmD,IAAI,CAACrD,KAAL,CAAWyD,QAAX,CAAoB,CAApB,CAAZ;AACArD,IAAAA,UAAU,GAAGF,SAAS,CAACuD,QAAV,CAAmB,CAAnB,CAAb;AACAzD,IAAAA,KAAK,CAAC2C,GAAN,CAAWU,IAAI,CAACrD,KAAhB;AAGH,GAXD,EAWG0D,SAXH,EAWc,UAAWC,KAAX,EAAmB;AAE7BC,IAAAA,OAAO,CAACD,KAAR,CAAeA,KAAf;AAEH,GAfD;AAiBAhD,EAAAA,CAAC,CAAC,gBAAD,CAAD,CAAoBkD,EAApB,CAAuB,QAAvB,EAAiCC,qBAAjC;AAEH,CAhEA,CAAD;;AAkEA,SAASC,WAAT,GAAuB;AACnBH,EAAAA,OAAO,CAACI,GAAR,CAAY,UAAZ;AACA,MAAIC,MAAM,GAAGlE,QAAQ,CAACmE,KAAT,CAAgBlE,KAAhB,EAAuB;AAAEmE,IAAAA,MAAM,EAAE;AAAV,GAAvB,CAAb;AACA,MAAIC,IAAI,GAAG,IAAIC,IAAJ,CAAU,CAAEJ,MAAF,CAAV,EAAsB;AAAEK,IAAAA,IAAI,EAAE;AAAR,GAAtB,CAAX;AACArE,EAAAA,IAAI,CAACsE,IAAL,GAAYC,GAAG,CAACC,eAAJ,CAAqBL,IAArB,CAAZ;AACAnE,EAAAA,IAAI,CAACyE,KAAL;AACH;;AAED,SAASZ,qBAAT,GAAkC;AAC9B;AACA1D,EAAAA,UAAU,CAACuE,MAAX,CAAkBxE,MAAlB;AACA,MAAIyE,MAAM,GAAGjE,CAAC,CAAC,gBAAD,CAAD,CAAoBkE,GAApB,EAAb;;AACA,MAAID,MAAM,CAACE,MAAX,EAAmB;AAEf,QAAItE,KAAK,GAAGF,OAAO,CAACsE,MAAD,CAAP,CAAgBpE,KAA5B;AACAH,IAAAA,MAAM,CAAC+C,IAAP,CAAa,uBAAqB5C,KAArB,GAA2B,MAAxC,EAAgD,UAAW6C,IAAX,EAAkB;AAC9DA,MAAAA,IAAI,CAACrD,KAAL,CAAWsD,QAAX,CAAqBC,KAAK,IAAI;AAE1B,YAAKA,KAAK,CAACjB,QAAX,EAAsBiB,KAAK,CAACjB,QAAN,CAAekB,SAAf,GAA2B,CAA3B;AAEzB,OAJD;AAKArD,MAAAA,MAAM,GAAGkD,IAAI,CAACrD,KAAL,CAAWyD,QAAX,CAAoB,CAApB,CAAT;AACAtD,MAAAA,MAAM,CAAC4E,QAAP,CAAgBhC,GAAhB,CAAoB,OAApB,EAA6B,CAA7B,EAAgC,CAAhC;AACA5C,MAAAA,MAAM,CAAC2C,QAAP,CAAgBC,GAAhB,CAAoB,EAApB,EAAuB,EAAvB,EAA0B,CAAC,GAA3B;AACA,UAAIiC,WAAW,GAAG,EAAlB;AACA7E,MAAAA,MAAM,CAAC8E,KAAP,CAAalC,GAAb,CAAiBiC,WAAjB,EAA8BA,WAA9B,EAA2CA,WAA3C;AACA5E,MAAAA,UAAU,CAACuC,GAAX,CAAgBxC,MAAhB;AACH,KAZD,EAYGuD,SAZH,EAYc,UAAWC,KAAX,EAAmB;AAE7BC,MAAAA,OAAO,CAACD,KAAR,CAAeA,KAAf;AAEH,KAhBD;AAiBH;AACJ"}